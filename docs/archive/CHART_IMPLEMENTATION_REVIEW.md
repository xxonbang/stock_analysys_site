# 분석 결과 페이지 그래프 추가 기술 검토

## 📊 웹 검색 기반 최적 그래프 구성 연구

### 1. 주식 분석에 적합한 그래프 종류

#### 1.1 필수 그래프 (High Priority)

**1. 주가 차트 (Price Chart)**
- **타입**: 캔들스틱 차트 또는 라인 차트
- **데이터**: historicalData (date, open, high, low, close)
- **효용성**: ⭐⭐⭐⭐⭐
  - 주가 추세와 변동성 시각화
  - 일일 가격 움직임 패턴 파악
  - 가장 기본적이고 중요한 정보
- **구성 요소**:
  - 주가 라인 (종가 기준)
  - 이동평균선 오버레이 (MA5, MA20, MA60, MA120)
  - 볼린저 밴드 오버레이 (상단/중심/하단)
  - 저항선/지지선 표시 (Phase 2 지표)

**2. 거래량 차트 (Volume Chart)**
- **타입**: 바 차트 (Bar Chart)
- **데이터**: historicalData (date, volume)
- **효용성**: ⭐⭐⭐⭐⭐
  - 가격 변동의 신뢰도 판단
  - 고거래량 구간 식별
  - 가격과 거래량의 관계 분석
- **구성 요소**:
  - 일일 거래량 바
  - 평균 거래량 라인
  - 고거래량 구간 하이라이트

**3. RSI 차트 (RSI Chart)**
- **타입**: 라인 차트 (별도 패널)
- **데이터**: marketData.rsi (현재값) + historicalData로 계산 가능
- **효용성**: ⭐⭐⭐⭐
  - 과매수/과매도 구간 시각화
  - 모멘텀 분석
- **구성 요소**:
  - RSI 라인 (0-100)
  - 기준선 (70, 30)
  - 과매수/과매도 영역 색상 구분

#### 1.2 보조 그래프 (Medium Priority)

**4. 기술적 지표 요약 차트**
- **타입**: 멀티 라인 차트 또는 스파크라인
- **데이터**: RSI, 이격도, 변동성 등
- **효용성**: ⭐⭐⭐
  - 여러 지표를 한눈에 비교
  - 지표 간 상관관계 파악

**5. 수급 데이터 차트 (한국 주식)**
- **타입**: 스택 바 차트 또는 라인 차트
- **데이터**: marketData.supplyDemand
- **효용성**: ⭐⭐⭐
  - 기관/외국인/개인 매매 동향 시각화
  - 스마트 머니 흐름 파악

#### 1.3 선택적 그래프 (Low Priority)

**6. 변동성 차트**
- **타입**: 영역 차트 (Area Chart)
- **데이터**: marketData.volatility
- **효용성**: ⭐⭐
  - 변동성 추이 시각화

**7. ETF 괴리율 차트 (ETF만)**
- **타입**: 라인 차트 또는 게이지
- **데이터**: marketData.etfPremium
- **효용성**: ⭐⭐
  - NAV 대비 프리미엄/할인 시각화

---

## 🛠️ 기술적 구현 검토

### 2. 차트 라이브러리 비교

#### 2.1 Recharts (추천) ⭐⭐⭐⭐⭐

**장점:**
- ✅ React 전용으로 설계되어 통합 우수
- ✅ 컴포넌트 기반 API (React 친화적)
- ✅ TypeScript 지원 우수
- ✅ 커스터마이징 용이
- ✅ 문서화 잘 되어 있음
- ✅ 번들 크기: ~200KB (gzipped)

**단점:**
- ⚠️ SVG 기반이라 큰 데이터셋(5000+ 포인트)에서 성능 저하
- ⚠️ 현재 프로젝트는 120일치 데이터이므로 문제 없음

**설치:**
```bash
npm install recharts
```

**사용 예시:**
```tsx
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend } from 'recharts';

<LineChart data={historicalData}>
  <Line dataKey="close" stroke="#8884d8" />
  <Line dataKey="ma20" stroke="#82ca9d" />
</LineChart>
```

#### 2.2 Chart.js + react-chartjs-2 ⭐⭐⭐⭐

**장점:**
- ✅ Canvas 기반으로 큰 데이터셋에 성능 우수
- ✅ 다양한 차트 타입 지원
- ✅ 넓은 커뮤니티

**단점:**
- ⚠️ React 래퍼 사용 필요 (통합 덜 자연스러움)
- ⚠️ 번들 크기: ~250KB (gzipped)
- ⚠️ TypeScript 타입 정의 추가 작업 필요

**설치:**
```bash
npm install chart.js react-chartjs-2
```

#### 2.3 비교 결과

| 항목 | Recharts | Chart.js |
|------|----------|----------|
| React 통합 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 성능 (120일 데이터) | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 커스터마이징 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| TypeScript 지원 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 번들 크기 | ⭐⭐⭐⭐ | ⭐⭐⭐ |
| 문서화 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **종합 추천도** | **⭐⭐⭐⭐⭐** | ⭐⭐⭐⭐ |

**결론: Recharts 추천**
- 현재 프로젝트는 120일치 데이터로 충분히 처리 가능
- React 통합이 더 자연스럽고 TypeScript 지원 우수
- 코드 가독성과 유지보수성 우수

---

## 📈 추천 그래프 구성

### 3. 최적 구성 (Phase 1)

#### 3.1 메인 주가 차트 (캔들스틱 + 오버레이)

**위치**: 리포트 페이지 상단, 대시보드 카드 아래

**구성:**
```
┌─────────────────────────────────────────┐
│ 주가 차트 (캔들스틱)                      │
│ - 캔들스틱 (시가/고가/저가/종가)          │
│ - 이동평균선 오버레이 (MA5, MA20, MA60)   │
│ - 볼린저 밴드 오버레이 (선택적)           │
│ - 저항선/지지선 표시 (선택적)             │
└─────────────────────────────────────────┘
```

**데이터 소스:**
- `stockData.historicalData` (120일치)
- `marketData.movingAverages` (MA5, MA20, MA60, MA120)
- `marketData.bollingerBands` (선택적)
- `marketData.supportResistance` (선택적)

**기능:**
- 줌/팬 (선택적)
- 호버 시 상세 정보 표시
- 반응형 디자인

#### 3.2 거래량 차트

**위치**: 주가 차트 바로 아래

**구성:**
```
┌─────────────────────────────────────────┐
│ 거래량 차트 (바 차트)                    │
│ - 일일 거래량 바                         │
│ - 평균 거래량 라인                       │
│ - 고거래량 구간 하이라이트               │
└─────────────────────────────────────────┘
```

**데이터 소스:**
- `stockData.historicalData` (volume)
- `marketData.volumeIndicators.averageVolume`

#### 3.3 RSI 차트

**위치**: 거래량 차트 아래 또는 사이드 패널

**구성:**
```
┌─────────────────────────────────────────┐
│ RSI (0-100)                             │
│ - RSI 라인                               │
│ - 기준선 (70, 30)                        │
│ - 과매수/과매도 영역 색상 구분           │
└─────────────────────────────────────────┘
```

**데이터 소스:**
- `marketData.rsi` (현재값)
- historicalData로 과거 RSI 계산 가능

### 3.2 확장 구성 (Phase 2)

#### 3.4 기술적 지표 대시보드

**위치**: 사이드 패널 또는 별도 섹션

**구성:**
- RSI 게이지
- 이격도 게이지
- 변동성 게이지
- 거래량 비율 게이지

#### 3.5 수급 데이터 차트 (한국 주식만)

**위치**: 별도 카드

**구성:**
- 기관/외국인/개인 순매수량 스택 바 차트
- 최근 N일 추이 라인 차트

---

## 🎨 UI/UX 고려사항

### 4. 디자인 원칙

1. **가독성 우선**
   - 명확한 색상 구분
   - 적절한 폰트 크기
   - 충분한 여백

2. **반응형 디자인**
   - 모바일: 단일 컬럼, 간소화된 차트
   - 데스크톱: 멀티 컬럼, 상세 차트

3. **인터랙티브 요소**
   - 호버 시 상세 정보 표시
   - 클릭 시 확대 (선택적)
   - 범례 토글

4. **성능 최적화**
   - 데이터 포인트 제한 (120일)
   - 지연 로딩
   - 메모이제이션

---

## 📦 구현 계획

### 5. 단계별 구현

#### Phase 1: 필수 그래프 (우선순위 높음)

1. **주가 차트 (라인 + 이동평균선)**
   - Recharts 설치
   - 기본 라인 차트 구현
   - 이동평균선 오버레이 추가
   - 반응형 디자인 적용

2. **거래량 차트**
   - 바 차트 구현
   - 평균 거래량 라인 추가

3. **RSI 차트**
   - 별도 패널에 RSI 라인 차트
   - 기준선 및 영역 표시

**예상 작업 시간**: 4-6시간
**난이도**: ⭐⭐⭐ (중)

#### Phase 2: 고급 기능 (선택적)

4. **볼린저 밴드 오버레이**
5. **저항선/지지선 표시**
6. **캔들스틱 차트 전환**
7. **줌/팬 기능**

**예상 작업 시간**: 3-4시간
**난이도**: ⭐⭐⭐⭐ (중상)

---

## 🔧 기술적 세부사항

### 6. 데이터 변환

**historicalData → 차트 데이터 형식:**
```typescript
interface ChartDataPoint {
  date: string; // "2024-01-15"
  close: number;
  open?: number;
  high?: number;
  low?: number;
  volume: number;
  ma5?: number;
  ma20?: number;
  ma60?: number;
  ma120?: number;
  bbUpper?: number;
  bbMiddle?: number;
  bbLower?: number;
  rsi?: number;
}
```

**변환 함수 필요:**
- `transformHistoricalDataToChartData()`: historicalData + 지표 → 차트 데이터

### 7. 성능 최적화

1. **메모이제이션**
   - `useMemo`로 차트 데이터 변환 캐싱
   - `React.memo`로 차트 컴포넌트 최적화

2. **지연 로딩**
   - 초기에는 기본 차트만 로드
   - 사용자 상호작용 시 추가 차트 로드

3. **데이터 샘플링**
   - 모바일에서는 데이터 포인트 간소화 (선택적)

---

## ✅ 결론 및 추천

### 8. 최종 추천

**라이브러리**: **Recharts** ⭐⭐⭐⭐⭐

**구현 우선순위:**
1. ✅ 주가 차트 (라인 + 이동평균선) - 필수
2. ✅ 거래량 차트 - 필수
3. ✅ RSI 차트 - 필수
4. ⚠️ 볼린저 밴드 오버레이 - 선택적
5. ⚠️ 캔들스틱 차트 - 선택적

**예상 효과:**
- 📈 사용자 경험 향상: 숫자만 보는 것보다 시각적 이해도 증가
- 📊 분석 효율성: 한눈에 추세 파악 가능
- 🎯 의사결정 지원: 그래프 기반 직관적 판단

**구현 난이도**: ⭐⭐⭐ (중)
**예상 작업 시간**: 4-6시간 (Phase 1)

---

## 📝 참고 자료

- Recharts 공식 문서: https://recharts.org/
- Chart.js 공식 문서: https://www.chartjs.org/
- 주식 차트 디자인 가이드: 웹 검색 결과 기반
