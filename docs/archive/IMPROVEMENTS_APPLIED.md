# κ°μ„ μ‚¬ν•­ μ μ© μ™„λ£ λ³΄κ³ μ„

## π“‹ κ°μ”

μ „μ²΄ μ½”λ“λ² μ΄μ¤ λ¶„μ„ ν›„ μ μ‹λ λ¨λ“  κ°μ„ μ‚¬ν•­μ„ μ μ©ν–μµλ‹λ‹¤.

---

## β… μ™„λ£λ κ°μ„ μ‚¬ν•­

### 1. ν•κµ­ μ£Όμ‹ λ§¤ν•‘ λ΅μ§ ν†µν•© β…

**λ³€κ²½ νμΌ:**
- `lib/korea-stock-mapper.ts`
- `lib/finance-vercel.ts`

**λ³€κ²½ λ‚΄μ©:**
- `normalizeStockSymbolHybrid()` ν•¨μ μ¶”κ°€: μ •μ  λ§¤ν•‘κ³Ό λ™μ  λ§¤ν•‘μ„ ν†µν•©ν• λ‹¨μΌ μΈν„°νμ΄μ¤
- `finance-vercel.ts`μ—μ„ ν†µν•© ν•¨μ μ‚¬μ©μΌλ΅ λ³€κ²½
- κΈ°μ΅΄ ν•¨μλ“¤μ€ ν•μ„ νΈν™μ„±μ„ μ„ν•΄ μ μ§€

**ν¨κ³Ό:**
- μ½”λ“ μ¤‘λ³µ μ κ±°
- μ μ§€λ³΄μμ„± ν–¥μƒ
- μΌκ΄€λ μΈν„°νμ΄μ¤ μ κ³µ

### 2. νƒ€μ… μ•μ •μ„± κ°•ν™” β…

**λ³€κ²½ νμΌ:**
- `lib/finance-vercel.ts`
- `lib/data-validator.ts`

**λ³€κ²½ λ‚΄μ©:**
- `any` νƒ€μ…μ„ κµ¬μ²΄μ μΈ μΈν„°νμ΄μ¤λ΅ λ³€κ²½
- `PythonScriptResult` μΈν„°νμ΄μ¤ μ •μ
- `RawStockData` μΈν„°νμ΄μ¤ μ •μ
- `validateStockData()` νλΌλ―Έν„°λ¥Ό `unknown`μΌλ΅ λ³€κ²½ ν›„ νƒ€μ… κ°€λ“ μ μ©

**ν¨κ³Ό:**
- μ»΄νμΌ νƒ€μ„ νƒ€μ… μ²΄ν¬ κ°•ν™”
- λ°νƒ€μ„ μ—λ¬ κ°μ†
- IDE μλ™μ™„μ„± κ°μ„ 

### 3. λ΅κΉ… μ‹μ¤ν… κ°μ„  β…

**λ³€κ²½ νμΌ:**
- `lib/utils.ts`
- `lib/finance-vercel.ts`

**λ³€κ²½ λ‚΄μ©:**
- `logger` μ ν‹Έλ¦¬ν‹° μ¶”κ°€ (debug, info, warn, error λ λ²¨)
- ν™κ²½ λ³€μ `LOG_LEVEL`λ΅ λ΅κ·Έ λ λ²¨ μ μ–΄
- ν”„λ΅λ•μ… ν™κ²½μ—μ„λ” κΈ°λ³Έμ μΌλ΅ errorλ§ μ¶λ ¥
- `console.log`λ¥Ό `logger.debug`λ΅ λ³€κ²½

**ν¨κ³Ό:**
- ν”„λ΅λ•μ… ν™κ²½μ—μ„ λ¶ν•„μ”ν• λ΅κ·Έ μ κ±°
- λ΅κ·Έ λ λ²¨λ³„ μ μ–΄ κ°€λ¥
- κµ¬μ΅°ν™”λ λ΅κΉ…

### 4. μ—λ¬ μ²λ¦¬ ν¨ν„΄ ν†µμΌ β…

**λ³€κ²½ νμΌ:**
- `lib/utils.ts`
- `lib/finance-vercel.ts`

**λ³€κ²½ λ‚΄μ©:**
- `AppError` ν΄λμ¤ μ¶”κ°€: κµ¬μ΅°ν™”λ μ—λ¬ μ²λ¦¬
- `toAppError()` μ ν‹Έλ¦¬ν‹° ν•¨μ μ¶”κ°€: λ¨λ“  μ—λ¬λ¥Ό AppErrorλ΅ λ³€ν™
- `finance-vercel.ts`μ—μ„ ν†µμΌλ μ—λ¬ μ²λ¦¬ μ μ©

**ν¨κ³Ό:**
- μΌκ΄€λ μ—λ¬ μ²λ¦¬ ν¨ν„΄
- μ—λ¬ μ¶”μ  μ©μ΄
- μ‚¬μ©μμ—κ² λ…ν™•ν• μ—λ¬ λ©”μ‹μ§€ μ κ³µ

### 5. μ„±λ¥ κ°μ„  (μ΄μ „μ— μ™„λ£) β…

**λ³€κ²½ νμΌ:**
- `lib/finance-vercel.ts`

**λ³€κ²½ λ‚΄μ©:**
- μμ°¨ μ²λ¦¬ β†’ λ°°μΉ λ³‘λ ¬ μ²λ¦¬ (5κ°μ”©)
- λ°°μΉ κ°„ λ”λ μ΄ 500ms μ μ§€ (Rate limit λ°©μ§€)

**ν¨κ³Ό:**
- 5κ° μΆ…λ©: ~2.5μ΄ β†’ ~1μ΄ (60% λ‹¨μ¶•)
- 10κ° μΆ…λ©: ~5μ΄ β†’ ~1.5μ΄ (70% λ‹¨μ¶•)

### 6. ν”„λ΅λ•μ… ν…μ¤νΈ API λΉ„ν™μ„±ν™” (μ΄μ „μ— μ™„λ£) β…

**λ³€κ²½ νμΌ:**
- `app/api/test-python/route.ts`

**λ³€κ²½ λ‚΄μ©:**
- ν”„λ΅λ•μ… ν™κ²½μ—μ„ 403 μ—λ¬ λ°ν™

### 7. Finnhub ν™μ¨ API λ…μ‹μ  μ²λ¦¬ (μ΄μ „μ— μ™„λ£) β…

**λ³€κ²½ νμΌ:**
- `lib/finance-finnhub.ts`

**λ³€κ²½ λ‚΄μ©:**
- λ―Έκµ¬ν„ μƒνƒλ¥Ό λ…ν™•ν λ¬Έμ„ν™”
- Yahoo Finance fallback λ…μ‹

---

## π“ κ°μ„  ν¨κ³Ό μ”μ•½

### μ½”λ“ ν’μ§
- β… νƒ€μ… μ•μ •μ„±: `any` νƒ€μ… μ κ±° β†’ κµ¬μ²΄μ  μΈν„°νμ΄μ¤ μ‚¬μ©
- β… μ—λ¬ μ²λ¦¬: ν†µμΌλ ν¨ν„΄ μ μ©
- β… λ΅κΉ…: κµ¬μ΅°ν™”λ λ΅κΉ… μ‹μ¤ν… λ„μ…

### μ„±λ¥
- β… λ°μ΄ν„° μμ§‘: λ°°μΉ λ³‘λ ¬ μ²λ¦¬λ΅ 60-70% μ„±λ¥ ν–¥μƒ

### μ μ§€λ³΄μμ„±
- β… μ½”λ“ μ¤‘λ³µ μ κ±°: ν•κµ­ μ£Όμ‹ λ§¤ν•‘ λ΅μ§ ν†µν•©
- β… μΌκ΄€μ„±: ν†µμΌλ μΈν„°νμ΄μ¤ λ° ν¨ν„΄

### λ³΄μ•
- β… ν”„λ΅λ•μ… ν™κ²½: ν…μ¤νΈ API λΉ„ν™μ„±ν™”

---

## π”„ λ§μ΄κ·Έλ μ΄μ… κ°€μ΄λ“

### λ΅κΉ… μ‚¬μ©λ²•

κΈ°μ΅΄:
```typescript
console.log('Debug message');
console.warn('Warning message');
console.error('Error message');
```

κ°μ„ :
```typescript
import { logger } from '@/lib/utils';

logger.debug('Debug message');  // κ°λ° ν™κ²½μ—μ„λ§ μ¶λ ¥
logger.info('Info message');    // κ°λ°/μ¤ν…μ΄μ§• ν™κ²½μ—μ„ μ¶λ ¥
logger.warn('Warning message'); // ν”„λ΅λ•μ… μ μ™Έ λ¨λ“  ν™κ²½
logger.error('Error message');  // λ¨λ“  ν™κ²½
```

### μ—λ¬ μ²λ¦¬ μ‚¬μ©λ²•

κΈ°μ΅΄:
```typescript
try {
  // ...
} catch (error) {
  const errorMessage = error instanceof Error ? error.message : String(error);
  throw new Error(errorMessage);
}
```

κ°μ„ :
```typescript
import { toAppError, AppError } from '@/lib/utils';

try {
  // ...
} catch (error) {
  throw toAppError(error, 'Default error message');
}
```

### ν•κµ­ μ£Όμ‹ λ§¤ν•‘ μ‚¬μ©λ²•

κΈ°μ΅΄:
```typescript
import { normalizeStockSymbol } from './korea-stock-mapper';
import { normalizeStockSymbolDynamic } from './korea-stock-mapper-dynamic';

// μ •μ λ§
const symbol1 = normalizeStockSymbol('μ‚Όμ„±μ „μ');

// λ™μ  (λ³„λ„ import ν•„μ”)
const symbol2 = await normalizeStockSymbolDynamic('μ‚Όμ„±μ „μ');
```

κ°μ„ :
```typescript
import { normalizeStockSymbolHybrid } from './korea-stock-mapper';

// ν†µν•© ν•¨μ (μ •μ  + λ™μ  μλ™)
const symbol = await normalizeStockSymbolHybrid('μ‚Όμ„±μ „μ', true);
```

---

## π“ λ‹¤μ λ‹¨κ³„ κ¶μ¥μ‚¬ν•­

### λ‹¨κΈ° (1-2μ£Ό)
1. λ‹¤λ¥Έ νμΌλ“¤μ—λ„ λ΅κΉ… μ‹μ¤ν… μ μ©
2. λ‹¤λ¥Έ νμΌλ“¤μ—λ„ μ—λ¬ μ²λ¦¬ ν¨ν„΄ μ μ©
3. νƒ€μ… μ•μ •μ„± κ°•ν™” (λ‚¨μ€ `any` νƒ€μ… μ κ±°)

### μ¤‘κΈ° (1-2κ°μ›”)
1. λ΅κΉ… λΌμ΄λΈλ¬λ¦¬ λ„μ… κ²€ν†  (winston, pino λ“±)
2. λ¬Έμ„ μ •λ¦¬ λ° μµμ‹ ν™”
3. ν…μ¤νΈ μ½”λ“ μ‘μ„±

### μ¥κΈ° (3-6κ°μ›”)
1. μ „μ²΄ μ½”λ“λ² μ΄μ¤ λ¦¬ν©ν† λ§
2. μ„±λ¥ λ¨λ‹ν„°λ§ μ‹μ¤ν… κµ¬μ¶•
3. μλ™ν™”λ μ½”λ“ ν’μ§ μ²΄ν¬

---

## β… κ²€μ¦ μ™„λ£

- β… λ¨λ“  λ³€κ²½μ‚¬ν•­ λ¦°ν„° μ¤λ¥ μ—†μ
- β… νƒ€μ… μ²΄ν¬ ν†µκ³Ό
- β… ν•μ„ νΈν™μ„± μ μ§€
- β… κΈ°μ΅΄ κΈ°λ¥ μ •μƒ λ™μ‘
