# KRX API 추가 신청 권장 사항

## 현재 신청한 API

1. ✅ **유가증권 일별매매정보** API
2. ✅ **ETF 일별매매정보** API

---

## 시스템에서 수집하는 데이터 분석

### 1. 기본 주식 정보 (✅ 유가증권 일별매매정보로 가능)
- 가격 정보: 시가, 고가, 저가, 종가
- 등락 정보: 대비, 등락률
- 거래 정보: 거래량, 거래대금
- 기타: 시가총액, 상장주식수

**결론:** ✅ 현재 신청한 API로 충분

---

### 2. 투자자별 매매동향 (❓ 확인 필요)

**현재 시스템에서 수집하는 데이터:**
- 기관 순매수량 (`institutional`)
- 외국인 순매수량 (`foreign`)
- 개인 순매수량 (`individual`)

**현재 코드 상태:**
- `lib/krx-api.ts`에서 "유가증권 일별매매정보"에 투자자별 정보가 포함될 수도 있고, 별도 API일 수도 있다고 가정
- 포함되지 않으면 네이버 크롤링으로 fallback

**KRX Open API 조사 결과:**
- KRX에는 **"투자자별 거래실적(개별종목)"** API가 별도로 존재할 가능성이 높음
- "유가증권 일별매매정보"에 포함될 수도 있지만, 별도 API가 더 상세한 정보를 제공할 수 있음

**권장 사항:**
- ⚠️ **"투자자별 거래실적(개별종목)" API 추가 신청 권장**
- 이유:
  1. 현재 "유가증권 일별매매정보"에 포함 여부 불확실
  2. 별도 API가 더 상세한 투자자별 데이터 제공 가능
  3. 네이버 크롤링 fallback보다 안정적

---

### 3. 과거 데이터 (120일) (❓ 확인 필요)

**현재 시스템에서 필요한 데이터:**
- 최근 120일치 일별 데이터 (종가, 거래량)
- 기술적 지표 계산용 (RSI, 이동평균선, 이격도)

**현재 데이터 소스:**
- Yahoo Finance (글로벌 주식)
- FinanceDataReader (한국 주식, Python)

**KRX Open API 조사 결과:**
- "유가증권 일별매매정보" API는 **기간을 지정해서 조회 가능**할 것으로 예상
- 예: `STD_DD` 파라미터로 시작일/종료일 지정

**권장 사항:**
- ✅ **현재 신청한 API로 가능할 것으로 예상**
- 단, API 승인 후 실제로 기간별 조회가 가능한지 확인 필요
- 기간별 조회가 불가능하면:
  - 매일 1회씩 120번 호출 필요 (비효율적)
  - 또는 별도 "과거 데이터 조회" API 확인 필요

---

### 4. 기술적 지표 (✅ 계산 가능)

**현재 시스템에서 계산하는 지표:**
- RSI (Relative Strength Index)
- 이동평균선 (MA5, MA20, MA60, MA120)
- 이격도 (Disparity)

**결론:**
- ✅ 과거 데이터만 있으면 자체 계산 가능
- 별도 API 불필요

---

## 최종 권장 사항

### 필수 추가 신청 (강력 권장)

#### 1. **투자자별 거래실적(개별종목) API** ⭐⭐⭐⭐⭐

**이유:**
- 현재 시스템의 핵심 기능 (수급 분석)
- 네이버 크롤링보다 안정적
- "유가증권 일별매매정보"에 포함 여부 불확실

**확인 방법:**
- KRX Open API 마이페이지에서 "투자자별 거래실적" 관련 API 검색
- 또는 "유가증권 일별매매정보" API 문서에서 투자자별 필드 포함 여부 확인

---

### 선택적 추가 신청 (확인 후 결정)

#### 2. **과거 데이터 조회 API** (기간별 일별매매정보) ⭐⭐⭐

**확인 필요 사항:**
- "유가증권 일별매매정보" API가 기간별 조회를 지원하는지
- 예: `STD_DD_FROM`, `STD_DD_TO` 같은 파라미터 존재 여부

**현재 대안:**
- FinanceDataReader (Python)로 과거 데이터 수집 가능
- KRX API로 기간별 조회가 불가능해도 대안 존재

**결론:**
- 기간별 조회가 가능하면 ✅ 현재 API로 충분
- 기간별 조회가 불가능하면 ⚠️ 별도 API 검토 필요

---

## 확인 체크리스트

### API 승인 후 확인할 사항

1. **유가증권 일별매매정보 API:**
   - [ ] 투자자별 매매동향 필드 포함 여부 (`INSTI_BY_QTY`, `FRGN_BY_QTY`, `PRSN_INBY_QTY`)
   - [ ] 기간별 조회 가능 여부 (시작일/종료일 파라미터)
   - [ ] 최대 조회 기간 제한

2. **ETF 일별매매정보 API:**
   - [ ] 기간별 조회 가능 여부
   - [ ] 최대 조회 기간 제한

3. **추가 API 검색:**
   - [ ] "투자자별 거래실적" 관련 API 존재 여부
   - [ ] "과거 데이터 조회" 관련 API 존재 여부

---

## 결론

### 즉시 추가 신청 권장
1. **투자자별 거래실적(개별종목) API** (강력 권장)

### 확인 후 결정
2. **과거 데이터 조회 API** (기간별 조회 불가능한 경우에만)

### 불필요
3. 기술적 지표 API (자체 계산 가능)

---

## 참고

- KRX Open API 마이페이지: https://openapi.krx.co.kr/
- API 서비스 목록: https://openapi.krx.co.kr/contents/OPP/USES/service/OPPUSES002_S1.cmd
- 현재 시스템은 네이버 크롤링 fallback이 완벽하게 작동하므로, 추가 API는 선택사항
